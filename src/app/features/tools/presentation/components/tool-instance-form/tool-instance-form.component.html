<section class="p-4">
  <form [formGroup]="formToolInstance" (ngSubmit)="onSubmit()">
    <!-- Información de Identificación -->
    <div class="mb-6">
      <h3 class="text-lg font-semibold mb-4 text-surface-700 border-b pb-2">
        Información de Identificación
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Código Serial -->
        <div>
          <label class="block text-sm font-medium mb-2 text-surface-600">
            Código Serial *
          </label>
          <input
            class="w-full"
            formControlName="serialCode"
            pInputText
            placeholder="Ej: 200011"
            autocomplete="on"
            [invalid]="isFieldInvalid('serialCode')"
          />
          @if(getFieldError('serialCode')) {
          <small class="p-error block mt-1">{{ getFieldError('serialCode') }}</small>
          }
        </div>

        <!-- Último Usuario Asignado -->
        <div>
          <label class="block text-sm font-medium mb-2 text-surface-600">
            Último Usuario Asignado
          </label>
          <input
            class="w-full"
            formControlName="lastAssignedUser"
            pInputText
            placeholder="Nombre del usuario"
            autocomplete="on"
          />
        </div>
      </div>
    </div>

    <!-- Configuración y Estado -->
    <div class="mb-6">
      <h3 class="text-lg font-semibold mb-4 text-surface-700 border-b pb-2">
        Configuración y Estado
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Taller -->
        <div>
          <label class="block text-sm font-medium mb-2 text-surface-600">
            Taller *
          </label>
          <p-select
            formControlName="garageId"
            [options]="garages"
            optionLabel="name"
            optionValue="uuid"
            placeholder="Seleccionar taller"
            styleClass="w-full"
            [invalid]="isFieldInvalid('garageId')"
            [showClear]="true"
          />
          @if(getFieldError('garageId')) {
          <small class="p-error block mt-1">{{ getFieldError('garageId') }}</small>
          }
        </div>

        <!-- Condición -->
        <div>
          <label class="block text-sm font-medium mb-2 text-surface-600">
            Condición *
          </label>
          <p-select
            formControlName="conditionId"
            [options]="conditions"
            optionLabel="description"
            optionValue="uuid"
            placeholder="Seleccionar condición"
            styleClass="w-full"
            [invalid]="isFieldInvalid('conditionId')"
            [showClear]="true"
          >
            <ng-template let-condition pTemplate="item">
              <div class="flex flex-col">
                <span class="font-semibold">{{ condition.description }}</span>
                <small class="text-surface-500">{{ condition.code }}</small>
              </div>
            </ng-template>
          </p-select>
          @if(getFieldError('conditionId')) {
          <small class="p-error block mt-1">{{ getFieldError('conditionId') }}</small>
          }
        </div>

        <!-- Estado -->
        <div>
          <label class="block text-sm font-medium mb-2 text-surface-600">
            Estado *
          </label>
          <p-select
            formControlName="status"
            [options]="statusOptions"
            optionLabel="label"
            optionValue="value"
            placeholder="Seleccionar estado"
            styleClass="w-full"
            [invalid]="isFieldInvalid('status')"
          />
          @if(getFieldError('status')) {
          <small class="p-error block mt-1">{{ getFieldError('status') }}</small>
          }
        </div>
      </div>
    </div>

    <!-- Acciones -->
    <div class="flex justify-end gap-3 pt-4 border-t">
      <p-button
        label="Cancelar"
        severity="secondary"
        type="button"
        [outlined]="true"
        icon="pi pi-times"
        (onClick)="onReset()"
      />
      <p-button
        label="Guardar"
        severity="info"
        type="submit"
        icon="pi pi-save"
        [disabled]="!formToolInstance.valid"
      />
    </div>
  </form>
</section>
