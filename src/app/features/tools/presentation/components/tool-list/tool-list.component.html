<div class="flex justify-end mb-4">
	<p-button
		label="Descargar Excel"
		icon="pi pi-file-excel"
		severity="help"
		(onClick)="downloadExcel()"
	/>
</div>

<section class="rounded-lg overflow-hidden border border-surface-200">
	<p-table
		[value]="tools"
		styleClass="p-datatable-sm p-datatable-striped"
		[tableStyle]="{'min-width': '50rem'}"
		rowGroupMode="subheader"
		groupRowsBy="categoryDisplay"
		[sortField]="'categoryDisplay'"
		[sortOrder]="1"
	>
		<ng-template #header>
			<tr>
				<th class="bg-surface-50">CÃ³digo</th>
				<th class="bg-surface-50">Nombre</th>
				<th class="bg-surface-50">Taller</th>
				<th class="bg-surface-50">Estado</th>
				<th class="bg-surface-50 text-center" style="width: 120px">Acciones</th>
			</tr>
		</ng-template>
		<ng-template #groupheader let-tool>
			<tr class="bg-primary-50">
				<td colspan="5">
					<div class="flex items-center gap-2 py-2">
						<i class="pi pi-tag text-primary"></i>
						<span class="font-bold text-primary">{{ tool.categoryDisplay }}</span>
					</div>
				</td>
			</tr>
		</ng-template>
		<ng-template #body let-tool>
			<tr class="hover:bg-surface-50 transition-colors">
				<td>
					<p-tag severity="info" [value]="tool.code" />
				</td>
				<td>
					<span class="font-medium text-surface-700">{{ tool.name }}</span>
				</td>
				<td>
					<p-tag severity="warn" [value]="tool.garageName" />
				</td>
				<td>
					<p-tag
						[severity]="tool.status === 'active' ? 'success' : 'danger'"
						[value]="tool.status === 'active' ? 'Activo' : 'Inactivo'"
					/>
				</td>
				<td>
					<div class="flex justify-center gap-1">
						<button
							type="button"
							class="p-2 rounded-full hover:bg-secondary-100 text-secondary transition-colors cursor-pointer border-0 bg-transparent"
							(click)="navigateToInstances(tool.uuid)"
							pTooltip="Ver instancias"
							tooltipPosition="top"
						>
							<i class="pi pi-box text-sm"></i>
						</button>
						<button
							type="button"
							class="p-2 rounded-full hover:bg-info-100 text-info transition-colors cursor-pointer border-0 bg-transparent"
							(click)="fetchToolByUuid(tool.uuid)"
							pTooltip="Editar herramienta"
							tooltipPosition="top"
						>
							<i class="pi pi-pencil text-sm"></i>
						</button>
						<button
							type="button"
							class="p-2 rounded-full hover:bg-danger-100 text-danger transition-colors cursor-pointer border-0 bg-transparent"
							(click)="onDeleteTool(tool.uuid)"
							pTooltip="Eliminar herramienta"
							tooltipPosition="top"
						>
							<i class="pi pi-trash text-sm"></i>
						</button>
					</div>
				</td>
			</tr>
		</ng-template>
		<ng-template #emptymessage>
			<tr>
				<td colspan="5" class="text-center py-8 text-surface-500">
					<i class="pi pi-inbox text-4xl mb-3 block"></i>
					<p>No hay herramientas registradas.</p>
				</td>
			</tr>
		</ng-template>
	</p-table>
</section>
