<section class="rounded-lg overflow-hidden border border-surface-200">
	<p-toast />
	<p-table
		[value]="assignments()"
		[loading]="isLoading()"
		styleClass="p-datatable-sm"
		[tableStyle]="{'min-width': '50rem'}"
	>
		<ng-template #header>
			<tr>
				<th class="bg-surface-50">Usuario</th>
				<th class="bg-surface-50">Herramienta</th>
				<th class="bg-surface-50">Salida</th>
				<th class="bg-surface-50">Regreso</th>
				<th class="bg-surface-50">Condici贸n Salida</th>
				<th class="bg-surface-50">Condici贸n Regreso</th>
				<th class="bg-surface-50">Estado</th>
				<th class="bg-surface-50 text-center" style="width: 100px">Acciones</th>
			</tr>
		</ng-template>
		<ng-template #body let-assignment>
			<tr class="hover:bg-surface-50 transition-colors">
				<td>
					<div class="flex items-center gap-2">
						<i class="pi pi-user text-info text-sm"></i>
						<span class="font-medium text-surface-700">{{ assignment.userAssigned }}</span>
					</div>
				</td>
				<td>
					<p-tag severity="secondary" [value]="assignment.toolInstance.serialCode" />
				</td>
				<td>
					<div class="flex items-center gap-2">
						<i class="pi pi-arrow-circle-right text-success text-sm"></i>
						<span class="text-sm">{{ assignment.fechaSalida | date:'dd/MM/yyyy HH:mm' }}</span>
					</div>
				</td>
				<td>
					@if (assignment.fechaRegreso) {
					<div class="flex items-center gap-2">
						<i class="pi pi-arrow-circle-left text-warn text-sm"></i>
						<span class="text-sm">{{ assignment.fechaRegreso | date:'dd/MM/yyyy HH:mm' }}</span>
					</div>
					} @else {
					<p-tag severity="contrast" value="Pendiente" />
					}
				</td>
				<td>
					<p-tag
						severity="info"
						[value]="assignment.conditionSalida?.code ?? 'N/A'"
					/>
				</td>
				<td>
					@if (assignment.conditionRegreso) {
					<p-tag
						severity="info"
						[value]="assignment.conditionRegreso?.code ?? 'N/A'"
					/>
					} @else {
					<p-tag severity="contrast" value="N/A" />
					}
				</td>
				<td>
					<p-tag [severity]="getStatusSeverity(assignment.status)" [value]="getStatusLabel(assignment.status)" />
				</td>
				<td>
					<div class="flex justify-center gap-1">
						<button
							type="button"
							class="p-2 rounded-full hover:bg-info-100 text-info transition-colors cursor-pointer border-0 bg-transparent"
							(click)="editAssignment(assignment)"
							pTooltip="Editar asignaci贸n"
							tooltipPosition="top"
						>
							<i class="pi pi-pencil text-sm"></i>
						</button>
						<button
							type="button"
							class="p-2 rounded-full hover:bg-danger-100 text-danger transition-colors cursor-pointer border-0 bg-transparent"
							(click)="deleteAssignment(assignment.uuid)"
							pTooltip="Eliminar asignaci贸n"
							tooltipPosition="top"
						>
							<i class="pi pi-trash text-sm"></i>
						</button>
					</div>
				</td>
			</tr>
		</ng-template>
	</p-table>
</section>
